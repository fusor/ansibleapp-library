FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDRkYWY1M2FlLTQ2MGQtNDMxOS04Njk4LTIxMjc0M2ExYTMzMApuYW1lOiBlbGItYXBiCmlt\
YWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvZWxiLWFwYgpkZXNjcmlwdGlvbjogRWxhc3RpYyBM\
b2FkIEJhbGFuY2luZwpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0aW9uYWwKcGFyYW1ldGVyczog\
e30KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJBbWF6b24gRUxCIgogIGxvbmdEZXNjcmlwdGlv\
bjogIkVsYXN0aWMgTG9hZCBCYWxhbmNpbmcgYXV0b21hdGljYWxseSBkaXN0cmlidXRlcyBpbmNv\
bWluZyBhcHBsaWNhdGlvbiB0cmFmZmljIGFjcm9zcyBtdWx0aXBsZSBBbWF6b24gRUMyIGluc3Rh\
bmNlcy4gSXQgZW5hYmxlcyB5b3UgdG8gYWNoaWV2ZSBmYXVsdCB0b2xlcmFuY2UgaW4geW91ciBh\
cHBsaWNhdGlvbnMsIHNlYW1sZXNzbHkgcHJvdmlkaW5nIHRoZSByZXF1aXJlZCBhbW91bnQgb2Yg\
bG9hZCBiYWxhbmNpbmcgY2FwYWNpdHkgbmVlZGVkIHRvIHJvdXRlIGFwcGxpY2F0aW9uIHRyYWZm\
aWMuIEVsYXN0aWMgTG9hZCBCYWxhbmNpbmcgb2ZmZXJzIHR3byB0eXBlcyBvZiBsb2FkIGJhbGFu\
Y2VycyB0aGF0IGJvdGggZmVhdHVyZSBoaWdoIGF2YWlsYWJpbGl0eSwgYXV0b21hdGljIHNjYWxp\
bmcsIGFuZCByb2J1c3Qgc2VjdXJpdHkuIFRoZXNlIGluY2x1ZGUgdGhlIENsYXNzaWMgTG9hZCBC\
YWxhbmNlciB0aGF0IHJvdXRlcyB0cmFmZmljIGJhc2VkIG9uIGVpdGhlciBhcHBsaWNhdGlvbiBv\
ciBuZXR3b3JrIGxldmVsIGluZm9ybWF0aW9uLCBhbmQgdGhlIEFwcGxpY2F0aW9uIExvYWQgQmFs\
YW5jZXIgdGhhdCByb3V0ZXMgdHJhZmZpYyBiYXNlZCBvbiBhZHZhbmNlZCBhcHBsaWNhdGlvbiBs\
ZXZlbCBpbmZvcm1hdGlvbiB0aGF0IGluY2x1ZGVzIHRoZSBjb250ZW50IG9mIHRoZSByZXF1ZXN0\
LiBUaGUgQ2xhc3NpYyBMb2FkIEJhbGFuY2VyIGlzIGlkZWFsIGZvciBzaW1wbGUgbG9hZCBiYWxh\
bmNpbmcgb2YgdHJhZmZpYyBhY3Jvc3MgbXVsdGlwbGUgRUMyIGluc3RhbmNlcywgd2hpbGUgdGhl\
IEFwcGxpY2F0aW9uIExvYWQgQmFsYW5jZXIgaXMgaWRlYWwgZm9yIGFwcGxpY2F0aW9ucyBuZWVk\
aW5nIGFkdmFuY2VkIHJvdXRpbmcgY2FwYWJpbGl0aWVzLCBtaWNyb3NlcnZpY2VzLCBhbmQgY29u\
dGFpbmVyLWJhc2VkIGFyY2hpdGVjdHVyZXMuIEFwcGxpY2F0aW9uIExvYWQgQmFsYW5jZXIgb2Zm\
ZXJzIGFiaWxpdHkgdG8gcm91dGUgdHJhZmZpYyB0byBtdWx0aXBsZSBzZXJ2aWNlcyBvciBsb2Fk\
IGJhbGFuY2UgYWNyb3NzIG11bHRpcGxlIHBvcnRzIG9uIHRoZSBzYW1lIEVDMiBpbnN0YW5jZS4i\
CiAgaW1hZ2VVcmw6ICJodHRwczovL3MzLmFtYXpvbmF3cy5jb20vZnVzb3IvMjAxN2RlbW8vTmV0\
d29ya2luZ0NvbnRlbnREZWxpdmVyeV9FbGFzdGljTG9hZEJhbGFuY2luZy5wbmciCiAgdGFnczoK\
ICAgIC0gQW1hem9uCiAgICAtIE5ldGV3b3JraW5nCiAgICAtIENvbnRlbnQgRGVsaXZlcnkKICBk\
b2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9lbGFzdGljbG9hZGJhbGFu\
Y2luZy8iCgo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
