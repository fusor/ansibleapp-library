FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDRkYWY1M2FlLTQ2MGQtNDMxOS04Njk4LTIxMjc0M2ExYTMzMApuYW1lOiBlbGItYXBiCmlt\
YWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvZWxiLWFwYgpkZXNjcmlwdGlvbjogRWxhc3RpYyBM\
b2FkIEJhbGFuY2luZwp0YWdzOgogIC0gYW1hem9uCiAgLSBuZXR3b3JraW5nCiAgLSBjb250ZW50\
LWRlbGl2ZXJ5CmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbApwYXJhbWV0ZXJzOiB7fQpt\
ZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIkFtYXpvbiBFTEIiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAi\
RWxhc3RpYyBMb2FkIEJhbGFuY2luZyBhdXRvbWF0aWNhbGx5IGRpc3RyaWJ1dGVzIGluY29taW5n\
IGFwcGxpY2F0aW9uIHRyYWZmaWMgYWNyb3NzIG11bHRpcGxlIEFtYXpvbiBFQzIgaW5zdGFuY2Vz\
LiBJdCBlbmFibGVzIHlvdSB0byBhY2hpZXZlIGZhdWx0IHRvbGVyYW5jZSBpbiB5b3VyIGFwcGxp\
Y2F0aW9ucywgc2VhbWxlc3NseSBwcm92aWRpbmcgdGhlIHJlcXVpcmVkIGFtb3VudCBvZiBsb2Fk\
IGJhbGFuY2luZyBjYXBhY2l0eSBuZWVkZWQgdG8gcm91dGUgYXBwbGljYXRpb24gdHJhZmZpYy4g\
RWxhc3RpYyBMb2FkIEJhbGFuY2luZyBvZmZlcnMgdHdvIHR5cGVzIG9mIGxvYWQgYmFsYW5jZXJz\
IHRoYXQgYm90aCBmZWF0dXJlIGhpZ2ggYXZhaWxhYmlsaXR5LCBhdXRvbWF0aWMgc2NhbGluZywg\
YW5kIHJvYnVzdCBzZWN1cml0eS4gVGhlc2UgaW5jbHVkZSB0aGUgQ2xhc3NpYyBMb2FkIEJhbGFu\
Y2VyIHRoYXQgcm91dGVzIHRyYWZmaWMgYmFzZWQgb24gZWl0aGVyIGFwcGxpY2F0aW9uIG9yIG5l\
dHdvcmsgbGV2ZWwgaW5mb3JtYXRpb24sIGFuZCB0aGUgQXBwbGljYXRpb24gTG9hZCBCYWxhbmNl\
ciB0aGF0IHJvdXRlcyB0cmFmZmljIGJhc2VkIG9uIGFkdmFuY2VkIGFwcGxpY2F0aW9uIGxldmVs\
IGluZm9ybWF0aW9uIHRoYXQgaW5jbHVkZXMgdGhlIGNvbnRlbnQgb2YgdGhlIHJlcXVlc3QuIFRo\
ZSBDbGFzc2ljIExvYWQgQmFsYW5jZXIgaXMgaWRlYWwgZm9yIHNpbXBsZSBsb2FkIGJhbGFuY2lu\
ZyBvZiB0cmFmZmljIGFjcm9zcyBtdWx0aXBsZSBFQzIgaW5zdGFuY2VzLCB3aGlsZSB0aGUgQXBw\
bGljYXRpb24gTG9hZCBCYWxhbmNlciBpcyBpZGVhbCBmb3IgYXBwbGljYXRpb25zIG5lZWRpbmcg\
YWR2YW5jZWQgcm91dGluZyBjYXBhYmlsaXRpZXMsIG1pY3Jvc2VydmljZXMsIGFuZCBjb250YWlu\
ZXItYmFzZWQgYXJjaGl0ZWN0dXJlcy4gQXBwbGljYXRpb24gTG9hZCBCYWxhbmNlciBvZmZlcnMg\
YWJpbGl0eSB0byByb3V0ZSB0cmFmZmljIHRvIG11bHRpcGxlIHNlcnZpY2VzIG9yIGxvYWQgYmFs\
YW5jZSBhY3Jvc3MgbXVsdGlwbGUgcG9ydHMgb24gdGhlIHNhbWUgRUMyIGluc3RhbmNlLiIKICBp\
bWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8yMDE3ZGVtby9OZXR3b3Jr\
aW5nQ29udGVudERlbGl2ZXJ5X0VsYXN0aWNMb2FkQmFsYW5jaW5nLnBuZyIKICBkb2N1bWVudGF0\
aW9uVXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9lbGFzdGljbG9hZGJhbGFuY2luZy8iCgo=\

ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
