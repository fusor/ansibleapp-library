FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDljZTQxMTQzLTFjNzYtNGZjMS05ODI4LTRmYmUyNjQ4ZWUyNApuYW1lOiByZWRzaGlmdC1h\
cGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9yZWRzaGlmdC1hcGIKZGVzY3JpcHRpb246\
IEZhc3QsIHNpbXBsZSwgY29zdC1lZmZlY3RpdmUgZGF0YSB3YXJlaG91c2luZy4KYmluZGFibGU6\
IHRydWUKYXN5bmM6IG9wdGlvbmFsCnBhcmFtZXRlcnM6IHt9Cm1ldGFkYXRhOgogIGRpc3BsYXlO\
YW1lOiAiQW1hem9uIFJlZHNoaWZ0IgogIGxvbmdEZXNjcmlwdGlvbjogIkFtYXpvbiBSZWRzaGlm\
dCBpcyBhIGZhc3QsIGZ1bGx5IG1hbmFnZWQsIHBldGFieXRlLXNjYWxlIGRhdGEgd2FyZWhvdXNl\
IHRoYXQgbWFrZXMgaXQgc2ltcGxlIGFuZCBjb3N0LWVmZmVjdGl2ZSB0byBhbmFseXplIGFsbCB5\
b3VyIGRhdGEgdXNpbmcgeW91ciBleGlzdGluZyBidXNpbmVzcyBpbnRlbGxpZ2VuY2UgdG9vbHMu\
IFN0YXJ0IHNtYWxsIGZvciAkMC4yNSBwZXIgaG91ciB3aXRoIG5vIGNvbW1pdG1lbnRzIGFuZCBz\
Y2FsZSB0byBwZXRhYnl0ZXMgZm9yICQxLDAwMCBwZXIgdGVyYWJ5dGUgcGVyIHllYXIsIGxlc3Mg\
dGhhbiBhIHRlbnRoIHRoZSBjb3N0IG9mIHRyYWRpdGlvbmFsIHNvbHV0aW9ucy4gQ3VzdG9tZXJz\
IHR5cGljYWxseSBzZWUgM3ggY29tcHJlc3Npb24sIHJlZHVjaW5nIHRoZWlyIGNvc3RzIHRvICQz\
MzMgcGVyIHVuY29tcHJlc3NlZCB0ZXJhYnl0ZSBwZXIgeWVhci4iCiAgaW1hZ2VVcmw6ICJodHRw\
czovL3MzLmFtYXpvbmF3cy5jb20vZnVzb3IvMjAxN2RlbW8vRGF0YWJhc2VfQW1hem9uUmVkc2hp\
ZnQucG5nIgogIHRhZ3M6CiAgICAtIEFtYXpvbgogICAgLSBEYXRhYmFzZQogIGRvY3VtZW50YXRp\
b25Vcmw6ICJodHRwczovL2F3cy5hbWF6b24uY29tL3JlZHNoaWZ0LyIK"
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
