FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDljZTQxMTQzLTFjNzYtNGZjMS05ODI4LTRmYmUyNjQ4ZWUyNApuYW1lOiByZWRzaGlmdC1h\
cGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9yZWRzaGlmdC1hcGIKZGVzY3JpcHRpb246\
IEZhc3QsIHNpbXBsZSwgY29zdC1lZmZlY3RpdmUgZGF0YSB3YXJlaG91c2luZy4KdGFnczoKICAt\
IGFtYXpvbgogIC0gZGF0YWJhc2UKYmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlvbmFsCnBhcmFt\
ZXRlcnM6IHt9Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIFJlZHNoaWZ0IgogIGxv\
bmdEZXNjcmlwdGlvbjogIkFtYXpvbiBSZWRzaGlmdCBpcyBhIGZhc3QsIGZ1bGx5IG1hbmFnZWQs\
IHBldGFieXRlLXNjYWxlIGRhdGEgd2FyZWhvdXNlIHRoYXQgbWFrZXMgaXQgc2ltcGxlIGFuZCBj\
b3N0LWVmZmVjdGl2ZSB0byBhbmFseXplIGFsbCB5b3VyIGRhdGEgdXNpbmcgeW91ciBleGlzdGlu\
ZyBidXNpbmVzcyBpbnRlbGxpZ2VuY2UgdG9vbHMuIFN0YXJ0IHNtYWxsIGZvciAkMC4yNSBwZXIg\
aG91ciB3aXRoIG5vIGNvbW1pdG1lbnRzIGFuZCBzY2FsZSB0byBwZXRhYnl0ZXMgZm9yICQxLDAw\
MCBwZXIgdGVyYWJ5dGUgcGVyIHllYXIsIGxlc3MgdGhhbiBhIHRlbnRoIHRoZSBjb3N0IG9mIHRy\
YWRpdGlvbmFsIHNvbHV0aW9ucy4gQ3VzdG9tZXJzIHR5cGljYWxseSBzZWUgM3ggY29tcHJlc3Np\
b24sIHJlZHVjaW5nIHRoZWlyIGNvc3RzIHRvICQzMzMgcGVyIHVuY29tcHJlc3NlZCB0ZXJhYnl0\
ZSBwZXIgeWVhci4iCiAgaW1hZ2VVcmw6ICJodHRwczovL3MzLmFtYXpvbmF3cy5jb20vZnVzb3Iv\
MjAxN2RlbW8vRGF0YWJhc2VfQW1hem9uUmVkc2hpZnQucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6\
ICJodHRwczovL2F3cy5hbWF6b24uY29tL3JlZHNoaWZ0LyIK"
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
