FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDBhYWFmYzEwLTEzMmItNDFhOC1hNThjLTczMjY4ZmYxMDA2YQpuYW1lOiByZHMtZGVtby1w\
b3N0Z3Jlcy1hcGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9yZHMtZGVtby1wb3N0Z3Jl\
cy1hcGIKZGVzY3JpcHRpb246IE1hbmFnZWQgcmVsYXRpb25hbCBkYXRhYmFzZSBzZXJ2aWNlIHdp\
dGggYSBjaG9pY2Ugb2Ygc2l4IHBvcHVsYXIgZGF0YWJhc2UgZW5naW5lcy4gIFNldCB1cCwgb3Bl\
cmF0ZSwgYW5kIHNjYWxlIGEgcmVsYXRpb25hbCBkYXRhYmFzZSBpbiB0aGUgY2xvdWQgd2l0aCBq\
dXN0IGEgZmV3IGNsaWNrcy4gCnRhZ3M6CiAgLSBhbWF6b24KICAtIGRhdGFiYXNlCmJpbmRhYmxl\
OiB0cnVlCmFzeW5jOiBvcHRpb25hbApwYXJhbWV0ZXJzOgogIC0gbmFtZTogYXdzX2FjY2Vzc19r\
ZXkKICAgIGRlc2NyaXB0aW9uOiBhd3MgYWNjZXNzIGtleSB0byBhdXRoZW50aWNhdGUgdG8gYXdz\
IHdpdGgKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogYXdzX3NlY3JldF9rZXkKICAgIGRlc2Ny\
aXB0aW9uOiBhd3Mgc2VjcmV0IGtleSB0byBhdXRoZW50aWNhdGUgdG8gYXdzIHdpdGgKICAgIHR5\
cGU6IHN0cmluZwogIC0gbmFtZTogYmFja3VwX3JldGVudGlvbgogICAgZGVzY3JpcHRpb246IGJh\
Y2t1cCByZXRlbnRpb24gcGVyaW9kCiAgICB0eXBlOiBpbnQKICAgIGRlZmF1bHQ6IDAKICAtIG5h\
bWU6IGRiX2VuZ2luZQogICAgZGVzY3JpcHRpb246IGRhdGFiYXNlIGVuZ2luZQogICAgdHlwZTog\
c3RyaW5nCiAgICBkZWZhdWx0OiBwb3N0Z3JlcwogIC0gbmFtZTogZGJfbmFtZQogICAgZGVzY3Jp\
cHRpb246IG5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIGNyZWF0ZQogICAgdHlwZTogc3RyaW5nCiAg\
ICBkZWZhdWx0OiB0ZXN0ZGIKICAtIG5hbWU6IGRiX3Bhc3N3b3JkCiAgICBkZXNjcmlwdGlvbjog\
bWFzdGVyIHBhc3N3b3JkCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IGRicGFzc3dkCiAg\
LSBuYW1lOiBkYl9zaXplCiAgICBkZXNjcmlwdGlvbjogc2l6ZSBvZiB0aGUgZGIgaW4gZ2IKICAg\
IHR5cGU6IGludAogICAgZGVmYXVsdDogMTAKICAtIG5hbWU6IGRiX3VzZXJuYW1lCiAgICBkZXNj\
cmlwdGlvbjogbWFzdGVyIGRiIHVzZXJuYW1lCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6\
IGRidXNlcgogIC0gbmFtZTogZW5naW5lX3ZlcnNpb24KICAgIGRlc2NyaXB0aW9uOiBkYiBlbmdp\
bmUgdmVyc2lvbgogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiA5LjYuMQogIC0gbmFtZTog\
aW5zdGFuY2VfdHlwZQogICAgZGVzY3JpcHRpb246IGF3cyBpbnN0YW5jZSB0eXBlCiAgICB0eXBl\
OiBzdHJpbmcKICAgIGRlZmF1bHQ6IGRiLm0zLm1lZGl1bQogIC0gbmFtZTogbmFtZXNwYWNlCiAg\
ICBkZXNjcmlwdGlvbjogTmFtZXNwYWNlIHRvIGRlcGxveSB0aGUgY2x1c3RlciB0bwogICAgdHlw\
ZTogc3RyaW5nCiAgICBkZWZhdWx0OiBmb3JlbWFuLWFuc2libGVhcHAKICAtIG5hbWU6IG9wZW5z\
aGlmdF90YXJnZXQKICAgIGRlc2NyaXB0aW9uOiB0YXJnZXQgb3BlbnNoaWZ0IGhvc3RzIHVybAog\
ICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBvcGVuc2hpZnRfdXNlcgogICAgZGVzY3JpcHRpb246\
IG9wZW5zaGlmdCB1c2VyIHRvIGF1dGhlbnRpY2F0ZSBhcwogICAgdHlwZTogc3RyaW5nCiAgLSBu\
YW1lOiBvcGVuc2hpZnRfcGFzcwogICAgZGVzY3JpcHRpb246IHBhc3N3b3JkIGZvciB0aGUgb3Bl\
bnNoaWZ0IHVzZXIKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogcG9ydAogICAgZGVzY3JpcHRp\
b246IHBvcnQgdGhlIGRhdGFiYXNlIHdpbGwgbGlzdGVuIG9uCiAgICB0eXBlOiBpbnQKICAgIGRl\
ZmF1bHQ6IDU0MzIKICAtIG5hbWU6IHJlZ2lvbgogICAgZGVzY3JpcHRpb246IGF3cyByZWdpb24K\
ICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogc3VibmV0CiAgICBkZXNjcmlwdGlvbjogdnBjIHN1\
Ym5ldCB0byBkZXBsb3kgaW5zdGFuY2Ugb24KICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogdnBj\
X3NlY3VyaXR5X2dyb3VwcwogICAgZGVzY3JpcHRpb246IHZwYyBzZWN1cml0eSBncm91cHMgdG8g\
YXNzaWduIHRvIHRoZSBpbnN0YW5jZQogICAgdHlwZTogc3RyaW5nCm1ldGFkYXRhOgogIGRpc3Bs\
YXlOYW1lOiAiQW1hem9uIFJEUyAtIFBvc3RncmVTUUwiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW1h\
em9uIFJlbGF0aW9uYWwgRGF0YWJhc2UgU2VydmljZSAoQW1hem9uIFJEUykgbWFrZXMgaXQgZWFz\
eSB0byBzZXQgdXAsIG9wZXJhdGUsIGFuZCBzY2FsZSBhIHJlbGF0aW9uYWwgZGF0YWJhc2UgaW4g\
dGhlIGNsb3VkLiBJdCBwcm92aWRlcyBjb3N0LWVmZmljaWVudCBhbmQgcmVzaXphYmxlIGNhcGFj\
aXR5IHdoaWxlIG1hbmFnaW5nIHRpbWUtY29uc3VtaW5nIGRhdGFiYXNlIGFkbWluaXN0cmF0aW9u\
IHRhc2tzLCBmcmVlaW5nIHlvdSB1cCB0byBmb2N1cyBvbiB5b3VyIGFwcGxpY2F0aW9ucyBhbmQg\
YnVzaW5lc3MuIEFtYXpvbiBSRFMgcHJvdmlkZXMgeW91IHNpeCBmYW1pbGlhciBkYXRhYmFzZSBl\
bmdpbmVzIHRvIGNob29zZSBmcm9tLCBpbmNsdWRpbmcgQW1hem9uIEF1cm9yYSwgUG9zdGdyZVNR\
TCwgTXlTUUwsIE1hcmlhREIsIE9yYWNsZSwgYW5kIE1pY3Jvc29mdCBTUUwgU2VydmVyLiIKICBp\
bWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8yMDE3ZGVtby9EYXRhYmFz\
ZV9BbWF6b25SRFNfUG9zdGdyZVNRTGluc3RhbmNlLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAi\
aHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9yZHMvIgo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
RUN yum -y install python-boto postgresql && yum clean all
USER 1001
