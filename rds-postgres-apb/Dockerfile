FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDBhYWFmYzEwLTEzMmItNDFhOC1hNThjLTczMjY4ZmYxMDA2YQpuYW1lOiByZHMtZGVtby1w\
b3N0Z3Jlcy1hcGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9yZHMtZGVtby1wb3N0Z3Jl\
cy1hcGIKZGVzY3JpcHRpb246IE1hbmFnZWQgcmVsYXRpb25hbCBkYXRhYmFzZSBzZXJ2aWNlIHdp\
dGggYSBjaG9pY2Ugb2Ygc2l4IHBvcHVsYXIgZGF0YWJhc2UgZW5naW5lcy4gIFNldCB1cCwgb3Bl\
cmF0ZSwgYW5kIHNjYWxlIGEgcmVsYXRpb25hbCBkYXRhYmFzZSBpbiB0aGUgY2xvdWQgd2l0aCBq\
dXN0IGEgZmV3IGNsaWNrcy4gCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbApwYXJhbWV0\
ZXJzOgogIC0gbmFtZTogYXdzX2FjY2Vzc19rZXkKICAgIGRlc2NyaXB0aW9uOiBhd3MgYWNjZXNz\
IGtleSB0byBhdXRoZW50aWNhdGUgdG8gYXdzIHdpdGgKICAgIHR5cGU6IHN0cmluZwogIC0gbmFt\
ZTogYXdzX3NlY3JldF9rZXkKICAgIGRlc2NyaXB0aW9uOiBhd3Mgc2VjcmV0IGtleSB0byBhdXRo\
ZW50aWNhdGUgdG8gYXdzIHdpdGgKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogYmFja3VwX3Jl\
dGVudGlvbgogICAgZGVzY3JpcHRpb246IGJhY2t1cCByZXRlbnRpb24gcGVyaW9kCiAgICB0eXBl\
OiBpbnQKICAgIGRlZmF1bHQ6IDAKICAtIG5hbWU6IGRiX2VuZ2luZQogICAgZGVzY3JpcHRpb246\
IGRhdGFiYXNlIGVuZ2luZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBwb3N0Z3Jlcwog\
IC0gbmFtZTogZGJfbmFtZQogICAgZGVzY3JpcHRpb246IG5hbWUgb2YgdGhlIGRhdGFiYXNlIHRv\
IGNyZWF0ZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiB0ZXN0ZGIKICAtIG5hbWU6IGRi\
X3Bhc3N3b3JkCiAgICBkZXNjcmlwdGlvbjogbWFzdGVyIHBhc3N3b3JkCiAgICB0eXBlOiBzdHJp\
bmcKICAgIGRlZmF1bHQ6IGRicGFzc3dkCiAgLSBuYW1lOiBkYl9zaXplCiAgICBkZXNjcmlwdGlv\
bjogc2l6ZSBvZiB0aGUgZGIgaW4gZ2IKICAgIHR5cGU6IGludAogICAgZGVmYXVsdDogMTAKICAt\
IG5hbWU6IGRiX3VzZXJuYW1lCiAgICBkZXNjcmlwdGlvbjogbWFzdGVyIGRiIHVzZXJuYW1lCiAg\
ICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IGRidXNlcgogIC0gbmFtZTogZW5naW5lX3ZlcnNp\
b24KICAgIGRlc2NyaXB0aW9uOiBkYiBlbmdpbmUgdmVyc2lvbgogICAgdHlwZTogc3RyaW5nCiAg\
ICBkZWZhdWx0OiA5LjYuMQogIC0gbmFtZTogaW5zdGFuY2VfdHlwZQogICAgZGVzY3JpcHRpb246\
IGF3cyBpbnN0YW5jZSB0eXBlCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IGRiLm0zLm1l\
ZGl1bQogIC0gbmFtZTogbmFtZXNwYWNlCiAgICBkZXNjcmlwdGlvbjogTmFtZXNwYWNlIHRvIGRl\
cGxveSB0aGUgY2x1c3RlciB0bwogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBmb3JlbWFu\
LWFuc2libGVhcHAKICAtIG5hbWU6IG9wZW5zaGlmdF90YXJnZXQKICAgIGRlc2NyaXB0aW9uOiB0\
YXJnZXQgb3BlbnNoaWZ0IGhvc3RzIHVybAogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBvcGVu\
c2hpZnRfdXNlcgogICAgZGVzY3JpcHRpb246IG9wZW5zaGlmdCB1c2VyIHRvIGF1dGhlbnRpY2F0\
ZSBhcwogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBvcGVuc2hpZnRfcGFzcwogICAgZGVzY3Jp\
cHRpb246IHBhc3N3b3JkIGZvciB0aGUgb3BlbnNoaWZ0IHVzZXIKICAgIHR5cGU6IHN0cmluZwog\
IC0gbmFtZTogcG9ydAogICAgZGVzY3JpcHRpb246IHBvcnQgdGhlIGRhdGFiYXNlIHdpbGwgbGlz\
dGVuIG9uCiAgICB0eXBlOiBpbnQKICAgIGRlZmF1bHQ6IDU0MzIKICAtIG5hbWU6IHJlZ2lvbgog\
ICAgZGVzY3JpcHRpb246IGF3cyByZWdpb24KICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogc3Vi\
bmV0CiAgICBkZXNjcmlwdGlvbjogdnBjIHN1Ym5ldCB0byBkZXBsb3kgaW5zdGFuY2Ugb24KICAg\
IHR5cGU6IHN0cmluZwogIC0gbmFtZTogdnBjX3NlY3VyaXR5X2dyb3VwcwogICAgZGVzY3JpcHRp\
b246IHZwYyBzZWN1cml0eSBncm91cHMgdG8gYXNzaWduIHRvIHRoZSBpbnN0YW5jZQogICAgdHlw\
ZTogc3RyaW5nCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIFJEUyAtIFBvc3RncmVT\
UUwiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW1hem9uIFJlbGF0aW9uYWwgRGF0YWJhc2UgU2Vydmlj\
ZSAoQW1hem9uIFJEUykgbWFrZXMgaXQgZWFzeSB0byBzZXQgdXAsIG9wZXJhdGUsIGFuZCBzY2Fs\
ZSBhIHJlbGF0aW9uYWwgZGF0YWJhc2UgaW4gdGhlIGNsb3VkLiBJdCBwcm92aWRlcyBjb3N0LWVm\
ZmljaWVudCBhbmQgcmVzaXphYmxlIGNhcGFjaXR5IHdoaWxlIG1hbmFnaW5nIHRpbWUtY29uc3Vt\
aW5nIGRhdGFiYXNlIGFkbWluaXN0cmF0aW9uIHRhc2tzLCBmcmVlaW5nIHlvdSB1cCB0byBmb2N1\
cyBvbiB5b3VyIGFwcGxpY2F0aW9ucyBhbmQgYnVzaW5lc3MuIEFtYXpvbiBSRFMgcHJvdmlkZXMg\
eW91IHNpeCBmYW1pbGlhciBkYXRhYmFzZSBlbmdpbmVzIHRvIGNob29zZSBmcm9tLCBpbmNsdWRp\
bmcgQW1hem9uIEF1cm9yYSwgUG9zdGdyZVNRTCwgTXlTUUwsIE1hcmlhREIsIE9yYWNsZSwgYW5k\
IE1pY3Jvc29mdCBTUUwgU2VydmVyLiIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdz\
LmNvbS9mdXNvci8yMDE3ZGVtby9EYXRhYmFzZV9BbWF6b25SRFNfUG9zdGdyZVNRTGluc3RhbmNl\
LnBuZyIKICB0YWdzOgogICAgLSBBbWF6b24KICAgIC0gRGF0YWJhc2UKICBkb2N1bWVudGF0aW9u\
VXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9yZHMvIgo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
RUN yum -y install python-boto postgresql && yum clean all
USER 1001
