FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDBhYWFmYzEwLTEzMmItNDFhOC1hNThjLTczMjY4ZmYxMDA2YQpuYW1lOiByZHMtcG9zdGdy\
ZXMtYXBiCmltYWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvcmRzLXBvc3RncmVzLWFwYgpkZXNj\
cmlwdGlvbjogTWFuYWdlZCByZWxhdGlvbmFsIGRhdGFiYXNlIHNlcnZpY2Ugd2l0aCBhIGNob2lj\
ZSBvZiBzaXggcG9wdWxhciBkYXRhYmFzZSBlbmdpbmVzLiAgU2V0IHVwLCBvcGVyYXRlLCBhbmQg\
c2NhbGUgYSByZWxhdGlvbmFsIGRhdGFiYXNlIGluIHRoZSBjbG91ZCB3aXRoIGp1c3QgYSBmZXcg\
Y2xpY2tzLiAKdGFnczoKICAtIGFtYXpvbgogIC0gZGF0YWJhc2UKYmluZGFibGU6IHRydWUKYXN5\
bmM6IG9wdGlvbmFsCnBhcmFtZXRlcnM6CiAgLSBuYW1lOiBhd3NfYWNjZXNzX2tleQogICAgZGVz\
Y3JpcHRpb246IGF3cyBhY2Nlc3Mga2V5IHRvIGF1dGhlbnRpY2F0ZSB0byBhd3Mgd2l0aAogICAg\
dHlwZTogc3RyaW5nCiAgLSBuYW1lOiBhd3Nfc2VjcmV0X2tleQogICAgZGVzY3JpcHRpb246IGF3\
cyBzZWNyZXQga2V5IHRvIGF1dGhlbnRpY2F0ZSB0byBhd3Mgd2l0aAogICAgdHlwZTogc3RyaW5n\
CiAgLSBuYW1lOiBiYWNrdXBfcmV0ZW50aW9uCiAgICBkZXNjcmlwdGlvbjogYmFja3VwIHJldGVu\
dGlvbiBwZXJpb2QKICAgIHR5cGU6IGludAogICAgZGVmYXVsdDogMAogIC0gbmFtZTogZGJfZW5n\
aW5lCiAgICBkZXNjcmlwdGlvbjogZGF0YWJhc2UgZW5naW5lCiAgICB0eXBlOiBzdHJpbmcKICAg\
IGRlZmF1bHQ6IHBvc3RncmVzCiAgLSBuYW1lOiBkYl9uYW1lCiAgICBkZXNjcmlwdGlvbjogbmFt\
ZSBvZiB0aGUgZGF0YWJhc2UgdG8gY3JlYXRlCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6\
IHRlc3RkYgogIC0gbmFtZTogZGJfcGFzc3dvcmQKICAgIGRlc2NyaXB0aW9uOiBtYXN0ZXIgcGFz\
c3dvcmQKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogZGJwYXNzd2QKICAtIG5hbWU6IGRi\
X3NpemUKICAgIGRlc2NyaXB0aW9uOiBzaXplIG9mIHRoZSBkYiBpbiBnYgogICAgdHlwZTogaW50\
CiAgICBkZWZhdWx0OiAxMAogIC0gbmFtZTogZGJfdXNlcm5hbWUKICAgIGRlc2NyaXB0aW9uOiBt\
YXN0ZXIgZGIgdXNlcm5hbWUKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogZGJ1c2VyCiAg\
LSBuYW1lOiBlbmdpbmVfdmVyc2lvbgogICAgZGVzY3JpcHRpb246IGRiIGVuZ2luZSB2ZXJzaW9u\
CiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IDkuNi4xCiAgLSBuYW1lOiBpbnN0YW5jZV90\
eXBlCiAgICBkZXNjcmlwdGlvbjogYXdzIGluc3RhbmNlIHR5cGUKICAgIHR5cGU6IHN0cmluZwog\
ICAgZGVmYXVsdDogZGIubTMubWVkaXVtCiAgLSBuYW1lOiBuYW1lc3BhY2UKICAgIGRlc2NyaXB0\
aW9uOiBOYW1lc3BhY2UgdG8gZGVwbG95IHRoZSBjbHVzdGVyIHRvCiAgICB0eXBlOiBzdHJpbmcK\
ICAgIGRlZmF1bHQ6IGZvcmVtYW4tYW5zaWJsZWFwcAogIC0gbmFtZTogb3BlbnNoaWZ0X3Rhcmdl\
dAogICAgZGVzY3JpcHRpb246IHRhcmdldCBvcGVuc2hpZnQgaG9zdHMgdXJsCiAgICB0eXBlOiBz\
dHJpbmcKICAtIG5hbWU6IG9wZW5zaGlmdF91c2VyCiAgICBkZXNjcmlwdGlvbjogb3BlbnNoaWZ0\
IHVzZXIgdG8gYXV0aGVudGljYXRlIGFzCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IG9wZW5z\
aGlmdF9wYXNzCiAgICBkZXNjcmlwdGlvbjogcGFzc3dvcmQgZm9yIHRoZSBvcGVuc2hpZnQgdXNl\
cgogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBwb3J0CiAgICBkZXNjcmlwdGlvbjogcG9ydCB0\
aGUgZGF0YWJhc2Ugd2lsbCBsaXN0ZW4gb24KICAgIHR5cGU6IGludAogICAgZGVmYXVsdDogNTQz\
MgogIC0gbmFtZTogcmVnaW9uCiAgICBkZXNjcmlwdGlvbjogYXdzIHJlZ2lvbgogICAgdHlwZTog\
c3RyaW5nCiAgLSBuYW1lOiBzdWJuZXQKICAgIGRlc2NyaXB0aW9uOiB2cGMgc3VibmV0IHRvIGRl\
cGxveSBpbnN0YW5jZSBvbgogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiB2cGNfc2VjdXJpdHlf\
Z3JvdXBzCiAgICBkZXNjcmlwdGlvbjogdnBjIHNlY3VyaXR5IGdyb3VwcyB0byBhc3NpZ24gdG8g\
dGhlIGluc3RhbmNlCiAgICB0eXBlOiBzdHJpbmcKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJB\
bWF6b24gUkRTIC0gUG9zdGdyZVNRTCIKICBsb25nRGVzY3JpcHRpb246ICJBbWF6b24gUmVsYXRp\
b25hbCBEYXRhYmFzZSBTZXJ2aWNlIChBbWF6b24gUkRTKSBtYWtlcyBpdCBlYXN5IHRvIHNldCB1\
cCwgb3BlcmF0ZSwgYW5kIHNjYWxlIGEgcmVsYXRpb25hbCBkYXRhYmFzZSBpbiB0aGUgY2xvdWQu\
IEl0IHByb3ZpZGVzIGNvc3QtZWZmaWNpZW50IGFuZCByZXNpemFibGUgY2FwYWNpdHkgd2hpbGUg\
bWFuYWdpbmcgdGltZS1jb25zdW1pbmcgZGF0YWJhc2UgYWRtaW5pc3RyYXRpb24gdGFza3MsIGZy\
ZWVpbmcgeW91IHVwIHRvIGZvY3VzIG9uIHlvdXIgYXBwbGljYXRpb25zIGFuZCBidXNpbmVzcy4g\
QW1hem9uIFJEUyBwcm92aWRlcyB5b3Ugc2l4IGZhbWlsaWFyIGRhdGFiYXNlIGVuZ2luZXMgdG8g\
Y2hvb3NlIGZyb20sIGluY2x1ZGluZyBBbWF6b24gQXVyb3JhLCBQb3N0Z3JlU1FMLCBNeVNRTCwg\
TWFyaWFEQiwgT3JhY2xlLCBhbmQgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIuIgogIGltYWdlVXJsOiAi\
aHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2Z1c29yLzIwMTdkZW1vL0RhdGFiYXNlX0FtYXpvblJE\
U19Qb3N0Z3JlU1FMaW5zdGFuY2UucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2F3\
cy5hbWF6b24uY29tL3Jkcy8iCg=="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
RUN yum -y install python-boto postgresql && yum clean all
USER 1001
