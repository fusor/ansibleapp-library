FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDllODc3MmE1LTczYWMtNGNhYi1hMDg5LWExNjdhMGQ5NzJhNQpuYW1lOiByb3V0ZTUzLWFw\
YgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3JvdXRlNTMtYXBiCmRlc2NyaXB0aW9uOiBI\
aWdobHkgYXZhaWxhYmxlIGFuZCBzY2FsYWJsZSBjbG91ZCBEb21haW4gTmFtZSBTeXN0ZW0gKERO\
Uykgd2ViIHNlcnZpY2UuCnRhZ3M6CiAgLSBhbWF6b24KICAtIG5ldHdvcmtpbmcKICAtIGNvbnRl\
bnQtZGVsaXZlcnkKYmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlvbmFsCnBhcmFtZXRlcnM6IHt9\
Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIFJvdXRlNTMiCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiAiQW1hem9uIFJvdXRlIDUzIGlzIGEgaGlnaGx5IGF2YWlsYWJsZSBhbmQgc2NhbGFibGUg\
Y2xvdWQgRG9tYWluIE5hbWUgU3lzdGVtIChETlMpIHdlYiBzZXJ2aWNlLiBJdCBpcyBkZXNpZ25l\
ZCB0byBnaXZlIGRldmVsb3BlcnMgYW5kIGJ1c2luZXNzZXMgYW4gZXh0cmVtZWx5IHJlbGlhYmxl\
IGFuZCBjb3N0IGVmZmVjdGl2ZSB3YXkgdG8gcm91dGUgZW5kIHVzZXJzIHRvIEludGVybmV0IGFw\
cGxpY2F0aW9ucyBieSB0cmFuc2xhdGluZyBuYW1lcyBsaWtlIHd3dy5leGFtcGxlLmNvbSBpbnRv\
IHRoZSBudW1lcmljIElQIGFkZHJlc3NlcyBsaWtlIDE5Mi4wLjIuMSB0aGF0IGNvbXB1dGVycyB1\
c2UgdG8gY29ubmVjdCB0byBlYWNoIG90aGVyLiBBbWF6b24gUm91dGUgNTMgaXMgZnVsbHkgY29t\
cGxpYW50IHdpdGggSVB2NiBhcyB3ZWxsLiIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9u\
YXdzLmNvbS9mdXNvci8yMDE3ZGVtby9OZXR3b3JraW5nQ29udGVudERlbGl2ZXJ5X0FtYXpvblJv\
dXRlNTMucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2F3cy5hbWF6b24uY29tL3Jv\
dXRlNTMvIgoK"
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
