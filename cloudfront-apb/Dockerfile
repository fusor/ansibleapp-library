FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDdmMzE3MDk0LTQ1YjctNDdkZS05OWNiLWE4OTczODQwZjRmMwpuYW1lOiBjbG91ZGZyb250\
LWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL2Nsb3VkZnJvbnQtYXBiCmRlc2NyaXB0\
aW9uOiBDb250ZW50IERlbGl2ZXJ5IE5ldHdvcmsgKENETikKdGFnczoKICAtIGFtYXpvbgogIC0g\
bmV0d29ya2luZwogIC0gY29udGVudC1kZWxpdmVyeQpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0\
aW9uYWwKcGFyYW1ldGVyczoge30KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJBbWF6b24gQ2xv\
dWRGcm9udCIKICBsb25nRGVzY3JpcHRpb246ICJBbWF6b24gQ2xvdWRGcm9udCBpcyBhIGdsb2Jh\
bCBjb250ZW50IGRlbGl2ZXJ5IG5ldHdvcmsgKENETikgc2VydmljZSB0aGF0IGFjY2VsZXJhdGVz\
IGRlbGl2ZXJ5IG9mIHlvdXIgd2Vic2l0ZXMsIEFQSXMsIHZpZGVvIGNvbnRlbnQgb3Igb3RoZXIg\
d2ViIGFzc2V0cy4gSXQgaW50ZWdyYXRlcyB3aXRoIG90aGVyIEFtYXpvbiBXZWIgU2VydmljZXMg\
cHJvZHVjdHMgdG8gZ2l2ZSBkZXZlbG9wZXJzIGFuZCBidXNpbmVzc2VzIGFuIGVhc3kgd2F5IHRv\
IGFjY2VsZXJhdGUgY29udGVudCB0byBlbmQgdXNlcnMgd2l0aCBubyBtaW5pbXVtIHVzYWdlIGNv\
bW1pdG1lbnRzLiIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8y\
MDE3ZGVtby9OZXR3b3JraW5nQ29udGVudERlbGl2ZXJ5X0FtYXpvbkNsb3VkRnJvbnQucG5nIgog\
IGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2F3cy5hbWF6b24uY29tL2Nsb3VkZnJvbnQvIgo=\

ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
