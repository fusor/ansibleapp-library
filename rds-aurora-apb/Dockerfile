FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDMzNGM2ZWU0LWVkNmEtNDUyMC05YzFiLWIwNjhkOGQ0YTdhNwpuYW1lOiByZHMtYXVyb3Jh\
LWFwYgppbWFnZTogYW5zaWJsZXBsYXlib29rYnVuZGxlL3Jkcy1hdXJvcmEtYXBiCmRlc2NyaXB0\
aW9uOiBNYW5hZ2VkIHJlbGF0aW9uYWwgZGF0YWJhc2Ugc2VydmljZSB3aXRoIGEgY2hvaWNlIG9m\
IHNpeCBwb3B1bGFyIGRhdGFiYXNlIGVuZ2luZXMuICBTZXQgdXAsIG9wZXJhdGUsIGFuZCBzY2Fs\
ZSBhIHJlbGF0aW9uYWwgZGF0YWJhc2UgaW4gdGhlIGNsb3VkIHdpdGgganVzdCBhIGZldyBjbGlj\
a3MuCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbApwYXJhbWV0ZXJzOiB7fQptZXRhZGF0\
YToKICBkaXNwbGF5TmFtZTogIkFtYXpvbiBSRFMgLSBBdXJvcmEiCiAgbG9uZ0Rlc2NyaXB0aW9u\
OiAiQW1hem9uIFJlbGF0aW9uYWwgRGF0YWJhc2UgU2VydmljZSAoQW1hem9uIFJEUykgbWFrZXMg\
aXQgZWFzeSB0byBzZXQgdXAsIG9wZXJhdGUsIGFuZCBzY2FsZSBhIHJlbGF0aW9uYWwgZGF0YWJh\
c2UgaW4gdGhlIGNsb3VkLiBJdCBwcm92aWRlcyBjb3N0LWVmZmljaWVudCBhbmQgcmVzaXphYmxl\
IGNhcGFjaXR5IHdoaWxlIG1hbmFnaW5nIHRpbWUtY29uc3VtaW5nIGRhdGFiYXNlIGFkbWluaXN0\
cmF0aW9uIHRhc2tzLCBmcmVlaW5nIHlvdSB1cCB0byBmb2N1cyBvbiB5b3VyIGFwcGxpY2F0aW9u\
cyBhbmQgYnVzaW5lc3MuIEFtYXpvbiBSRFMgcHJvdmlkZXMgeW91IHNpeCBmYW1pbGlhciBkYXRh\
YmFzZSBlbmdpbmVzIHRvIGNob29zZSBmcm9tLCBpbmNsdWRpbmcgQW1hem9uIEF1cm9yYSwgUG9z\
dGdyZVNRTCwgTXlTUUwsIE1hcmlhREIsIE9yYWNsZSwgYW5kIE1pY3Jvc29mdCBTUUwgU2VydmVy\
LiIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8yMDE3ZGVtby9E\
YXRhYmFzZV9BbWF6b25SRFMucG5nIgogIHRhZ3M6CiAgICAtIEFtYXpvbgogICAgLSBEYXRhYmFz\
ZQogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2F3cy5hbWF6b24uY29tL3Jkcy8iCgo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
