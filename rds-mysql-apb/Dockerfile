FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDIwMmEyNDMyLTFkMWEtNDE4Mi1hYTM1LTAwNDAyZmZjNWVlMwpuYW1lOiByZHMtbXlzcWwt\
YXBiCmltYWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvcmRzLW15c3FsLWFwYgpkZXNjcmlwdGlv\
bjogTWFuYWdlZCByZWxhdGlvbmFsIGRhdGFiYXNlIHNlcnZpY2Ugd2l0aCBhIGNob2ljZSBvZiBz\
aXggcG9wdWxhciBkYXRhYmFzZSBlbmdpbmVzLiAgU2V0IHVwLCBvcGVyYXRlLCBhbmQgc2NhbGUg\
YSByZWxhdGlvbmFsIGRhdGFiYXNlIGluIHRoZSBjbG91ZCB3aXRoIGp1c3QgYSBmZXcgY2xpY2tz\
Lgp0YWdzOgogIC0gYW1hem9uCiAgLSBkYXRhYmFzZQpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0\
aW9uYWwKcGFyYW1ldGVyczoge30KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJBbWF6b24gUkRT\
IC0gTXlTUUwiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW1hem9uIFJlbGF0aW9uYWwgRGF0YWJhc2Ug\
U2VydmljZSAoQW1hem9uIFJEUykgbWFrZXMgaXQgZWFzeSB0byBzZXQgdXAsIG9wZXJhdGUsIGFu\
ZCBzY2FsZSBhIHJlbGF0aW9uYWwgZGF0YWJhc2UgaW4gdGhlIGNsb3VkLiBJdCBwcm92aWRlcyBj\
b3N0LWVmZmljaWVudCBhbmQgcmVzaXphYmxlIGNhcGFjaXR5IHdoaWxlIG1hbmFnaW5nIHRpbWUt\
Y29uc3VtaW5nIGRhdGFiYXNlIGFkbWluaXN0cmF0aW9uIHRhc2tzLCBmcmVlaW5nIHlvdSB1cCB0\
byBmb2N1cyBvbiB5b3VyIGFwcGxpY2F0aW9ucyBhbmQgYnVzaW5lc3MuIEFtYXpvbiBSRFMgcHJv\
dmlkZXMgeW91IHNpeCBmYW1pbGlhciBkYXRhYmFzZSBlbmdpbmVzIHRvIGNob29zZSBmcm9tLCBp\
bmNsdWRpbmcgQW1hem9uIEF1cm9yYSwgUG9zdGdyZVNRTCwgTXlTUUwsIE1hcmlhREIsIE9yYWNs\
ZSwgYW5kIE1pY3Jvc29mdCBTUUwgU2VydmVyLiIKICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1h\
em9uYXdzLmNvbS9mdXNvci8yMDE3ZGVtby9EYXRhYmFzZV9BbWF6b25SRFNfTXlTUUxEQmluc3Rh\
bmNlLnBuZyIKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9yZHMv\
Igo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
