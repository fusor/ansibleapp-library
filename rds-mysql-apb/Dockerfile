FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDIwMmEyNDMyLTFkMWEtNDE4Mi1hYTM1LTAwNDAyZmZjNWVlMwpuYW1lOiByZHMtbXlzcWwt\
YXBiCmltYWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvcmRzLW15c3FsLWFwYgpkZXNjcmlwdGlv\
bjogTWFuYWdlZCByZWxhdGlvbmFsIGRhdGFiYXNlIHNlcnZpY2Ugd2l0aCBhIGNob2ljZSBvZiBz\
aXggcG9wdWxhciBkYXRhYmFzZSBlbmdpbmVzLiAgU2V0IHVwLCBvcGVyYXRlLCBhbmQgc2NhbGUg\
YSByZWxhdGlvbmFsIGRhdGFiYXNlIGluIHRoZSBjbG91ZCB3aXRoIGp1c3QgYSBmZXcgY2xpY2tz\
LgpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0aW9uYWwKcGFyYW1ldGVyczoge30KbWV0YWRhdGE6\
CiAgZGlzcGxheU5hbWU6ICJBbWF6b24gUkRTIC0gTXlTUUwiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAi\
QW1hem9uIFJlbGF0aW9uYWwgRGF0YWJhc2UgU2VydmljZSAoQW1hem9uIFJEUykgbWFrZXMgaXQg\
ZWFzeSB0byBzZXQgdXAsIG9wZXJhdGUsIGFuZCBzY2FsZSBhIHJlbGF0aW9uYWwgZGF0YWJhc2Ug\
aW4gdGhlIGNsb3VkLiBJdCBwcm92aWRlcyBjb3N0LWVmZmljaWVudCBhbmQgcmVzaXphYmxlIGNh\
cGFjaXR5IHdoaWxlIG1hbmFnaW5nIHRpbWUtY29uc3VtaW5nIGRhdGFiYXNlIGFkbWluaXN0cmF0\
aW9uIHRhc2tzLCBmcmVlaW5nIHlvdSB1cCB0byBmb2N1cyBvbiB5b3VyIGFwcGxpY2F0aW9ucyBh\
bmQgYnVzaW5lc3MuIEFtYXpvbiBSRFMgcHJvdmlkZXMgeW91IHNpeCBmYW1pbGlhciBkYXRhYmFz\
ZSBlbmdpbmVzIHRvIGNob29zZSBmcm9tLCBpbmNsdWRpbmcgQW1hem9uIEF1cm9yYSwgUG9zdGdy\
ZVNRTCwgTXlTUUwsIE1hcmlhREIsIE9yYWNsZSwgYW5kIE1pY3Jvc29mdCBTUUwgU2VydmVyLiIK\
ICBpbWFnZVVybDogImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9mdXNvci8yMDE3ZGVtby9EYXRh\
YmFzZV9BbWF6b25SRFNfTXlTUUxEQmluc3RhbmNlLnBuZyIKICB0YWdzOgogICAgLSBBbWF6b24K\
ICAgIC0gRGF0YWJhc2UKICBkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNv\
bS9yZHMvIgo="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
