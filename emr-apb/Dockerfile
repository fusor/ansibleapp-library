FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IGM5ZjhmOGUxLTgxZmYtNDgyNS1hZTI2LTk0ZmIxMjY5NmYyMApuYW1lOiBlbXItYXBiCmlt\
YWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvZW1yLWFwYgpkZXNjcmlwdGlvbjogRWFzaWx5IFJ1\
biBhbmQgU2NhbGUgQXBhY2hlIEhhZG9vcCwgU3BhcmssIEhCYXNlLCBQcmVzdG8sIEhpdmUsIGFu\
ZCBvdGhlciBCaWcgRGF0YSBGcmFtZXdvcmtzCnRhZ3M6CiAgLSBhbWF6b24KICAtIGFuYWx5dGlj\
cwpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0aW9uYWwKcGFyYW1ldGVyczoge30KbWV0YWRhdGE6\
CiAgZGlzcGxheU5hbWU6ICJBbWF6b24gRU1SIgogIGxvbmdEZXNjcmlwdGlvbjogIkFtYXpvbiBF\
TVIgcHJvdmlkZXMgYSBtYW5hZ2VkIEhhZG9vcCBmcmFtZXdvcmsgdGhhdCBtYWtlcyBpdCBlYXN5\
LCBmYXN0LCBhbmQgY29zdC1lZmZlY3RpdmUgdG8gcHJvY2VzcyB2YXN0IGFtb3VudHMgb2YgZGF0\
YSBhY3Jvc3MgZHluYW1pY2FsbHkgc2NhbGFibGUgQW1hem9uIEVDMiBpbnN0YW5jZXMuIFlvdSBj\
YW4gYWxzbyBydW4gb3RoZXIgcG9wdWxhciBkaXN0cmlidXRlZCBmcmFtZXdvcmtzIHN1Y2ggYXMg\
QXBhY2hlIFNwYXJrLCBIQmFzZSwgUHJlc3RvLCBhbmQgRmxpbmsgaW4gQW1hem9uIEVNUiwgYW5k\
IGludGVyYWN0IHdpdGggZGF0YSBpbiBvdGhlciBBV1MgZGF0YSBzdG9yZXMgc3VjaCBhcyBBbWF6\
b24gUzMgYW5kIEFtYXpvbiBEeW5hbW9EQi4iCiAgaW1hZ2VVcmw6ICJodHRwczovL3MzLmFtYXpv\
bmF3cy5jb20vZnVzb3IvMjAxN2RlbW8vQW5hbHl0aWNzX0FtYXpvbkVNUi5wbmciCiAgZG9jdW1l\
bnRhdGlvblVybDogImh0dHBzOi8vYXdzLmFtYXpvbi5jb20vZW1yLyIK"
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
