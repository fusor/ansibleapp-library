FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDY1MGZjN2MzLTEyZTMtNGNjZS1iMzZjLTI5ODRlMDc2NzY4ZApuYW1lOiBlbGFzdGljYWNo\
ZS1hcGIKaW1hZ2U6IGFuc2libGVwbGF5Ym9va2J1bmRsZS9lbGFzdGljYWNoZS1hcGIKZGVzY3Jp\
cHRpb246IEZ1bGx5IG1hbmFnZWQsIGluLW1lbW9yeSBkYXRhIHN0b3JlIGFuZCBjYWNoZSBpbiB0\
aGUgY2xvdWQuIENvbXBhdGlibGUgd2l0aCBSZWRpcyBhbmQgTWVtY2FjaGVkLiAgUHJvdmlkZXMg\
c3ViLW1pbGxpc2Vjb25kIGxhdGVuY3kgdG8gcG93ZXIgcmVhbC10aW1lIGFwcGxpY2F0aW9ucy4K\
dGFnczoKICAtIGFtYXpvbgogIC0gZGF0YWJhc2UKYmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlv\
bmFsCnBhcmFtZXRlcnM6IHt9Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIEVsYXN0\
aUNhY2hlIgogIGxvbmdEZXNjcmlwdGlvbjogIkFtYXpvbiBFbGFzdGlDYWNoZSBpcyBhIHdlYiBz\
ZXJ2aWNlIHRoYXQgbWFrZXMgaXQgZWFzeSB0byBkZXBsb3ksIG9wZXJhdGUsIGFuZCBzY2FsZSBh\
biBpbi1tZW1vcnkgZGF0YSBzdG9yZSBvciBjYWNoZSBpbiB0aGUgY2xvdWQuIFRoZSBzZXJ2aWNl\
IGltcHJvdmVzIHRoZSBwZXJmb3JtYW5jZSBvZiB3ZWIgYXBwbGljYXRpb25zIGJ5IGFsbG93aW5n\
IHlvdSB0byByZXRyaWV2ZSBpbmZvcm1hdGlvbiBmcm9tIGZhc3QsIG1hbmFnZWQsIGluLW1lbW9y\
eSBkYXRhIHN0b3JlcywgaW5zdGVhZCBvZiByZWx5aW5nIGVudGlyZWx5IG9uIHNsb3dlciBkaXNr\
LWJhc2VkIGRhdGFiYXNlcy4iCiAgaW1hZ2VVcmw6ICJodHRwczovL3MzLmFtYXpvbmF3cy5jb20v\
ZnVzb3IvMjAxN2RlbW8vRGF0YWJhc2VfQW1hem9uRWxhc3RpY0NhY2hlLnBuZyIKICBkb2N1bWVu\
dGF0aW9uVXJsOiAiaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9lbGFzdGljYWNoZS8iCg=="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
